/*
 * angular-gridster
 * http://manifestwebdesign.github.io/angular-gridster
 *
 * @version: 0.13.17
 * @license: MIT
 */
!function(e,t){"use strict";"function"==typeof define&&define.amd?define(["angular"],t):"object"==typeof exports?module.exports=t(require("angular")):t(e.angular)}(this,function(R){"use strict";return R.module("gridster",[]).constant("gridsterConfig",{columns:6,pushing:!0,floating:!0,swapping:!1,width:"auto",colWidth:"auto",rowHeight:"match",margins:[10,10],outerMargin:!0,sparse:!1,isMobile:!1,mobileBreakPoint:600,mobileModeEnabled:!0,minColumns:1,minRows:1,maxRows:100,defaultSizeX:2,defaultSizeY:1,minSizeX:1,maxSizeX:null,minSizeY:1,maxSizeY:null,saveGridItemCalculatedHeightInMobile:!1,resizable:{enabled:!0,handles:["s","e","n","w","se","ne","sw","nw"]},draggable:{enabled:!0,scrollSensitivity:20,scrollSpeed:15}}).controller("GridsterCtrl",["gridsterConfig","$timeout","$rootScope",function(e,t,i){var r=this;R.extend(this,e),this.resizable=R.extend({},e.resizable||{}),this.draggable=R.extend({},e.draggable||{});var n=r.initialSetupComplete=!1;this.layoutChanged=function(){n||(n=!0,t(function(){n=!1,r.loaded&&r.floatItemsUp(),r.updateHeight(r.movingItem?r.movingItem.sizeY:0);var e=r.grid.flat().filter(function(e){return null!=e});0<e.length&&e.every(function(e){return e.initialSetup})&&!r.initialSetupComplete&&(i.$broadcast("gridster-setup-complete"),r.initialSetupComplete=!0)},30))},this.grid=[],this.allItems=[],this.destroy=function(){this.grid&&(this.grid=[]),this.$element=null,this.allItems&&(this.allItems.length=0,this.allItems=null)},this.setOptions=function(e){if(e)if((e=R.extend({},e)).draggable&&(R.extend(this.draggable,e.draggable),delete e.draggable),e.resizable&&(R.extend(this.resizable,e.resizable),delete e.resizable),R.extend(this,e),this.margins&&2===this.margins.length)for(var t=0,i=this.margins.length;t<i;++t)this.margins[t]=parseInt(this.margins[t],10),isNaN(this.margins[t])&&(this.margins[t]=0);else this.margins=[0,0]},this.canItemOccupy=function(e,t,i){return-1<t&&-1<i&&e.sizeX+i<=this.columns&&e.sizeY+t<=this.maxRows},this.autoSetItemPosition=function(e){for(var t=0;t<this.maxRows;++t)for(var i=0;i<this.columns;++i){if(0===this.getItems(t,i,e.sizeX,e.sizeY,e).length&&this.canItemOccupy(e,t,i))return void this.putItem(e,t,i)}throw new Error("Unable to place item!")},this.getItems=function(e,t,i,r,n){var s,o=[];if(i&&r||(i=r=1),!n||n instanceof Array||(n=[n]),!1===this.sparse)for(var a=0;a<r;++a)for(var l=0;l<i;++l)!(s=this.getItem(e+a,t+l,n))||n&&-1!==n.indexOf(s)||-1!==o.indexOf(s)||o.push(s);else for(var d=e+r-1,h=t+i-1,u=0;u<this.allItems.length;++u)!(s=this.allItems[u])||n&&-1!==n.indexOf(s)||-1!==o.indexOf(s)||!this.intersect(s,t,h,e,d)||o.push(s);return o},this.getBoundingBox=function(e){if(0===e.length)return null;if(1===e.length)return{row:e[0].row,col:e[0].col,sizeY:e[0].sizeY,sizeX:e[0].sizeX};for(var t=0,i=0,r=9999,n=9999,s=0,o=e.length;s<o;++s)var a=e[s],r=Math.min(a.row,r),n=Math.min(a.col,n),t=Math.max(a.row+a.sizeY,t),i=Math.max(a.col+a.sizeX,i);return{row:r,col:n,sizeY:t-r,sizeX:i-n}},this.intersect=function(e,t,i,r,n){return t<=e.col+e.sizeX-1&&i>=e.col&&r<=e.row+e.sizeY-1&&n>=e.row},this.removeItem=function(e){for(var t,i=0,r=this.grid.length;i<r;++i){var n=this.grid[i];if(n&&-1!==(t=n.indexOf(e))){n[t]=null;break}}this.sparse&&-1!==(t=this.allItems.indexOf(e))&&this.allItems.splice(t,1),this.layoutChanged()},this.getItem=function(e,t,i){!i||i instanceof Array||(i=[i]);for(var r=1;-1<e;){for(var n=1,s=t;-1<s;){var o=this.grid[e];if(o){var a=o[s];if(a&&(!i||-1===i.indexOf(a))&&a.sizeX>=n&&a.sizeY>=r)return a}++n,--s}--e,++r}return null},this.putItems=function(e){for(var t=0,i=e.length;t<i;++t)this.putItem(e[t])},this.putItem=function(e,t,i,r){if(null!=t||(t=e.row,i=e.col,null!=t)){if(this.canItemOccupy(e,t,i)||(i=Math.min(this.columns-e.sizeX,Math.max(0,i)),t=Math.min(this.maxRows-e.sizeY,Math.max(0,t))),null!==e.oldRow&&void 0!==e.oldRow){var n=e.oldRow===t&&e.oldColumn===i,s=this.grid[t]&&this.grid[t][i]===e;if(n&&s)return e.row=t,void(e.col=i);var o=this.grid[e.oldRow];o&&o[e.oldColumn]===e&&delete o[e.oldColumn]}e.oldRow=e.row=t,e.oldColumn=e.col=i,this.moveOverlappingItems(e,r),this.grid[t]||(this.grid[t]=[]),this.grid[t][i]=e,this.sparse&&-1===this.allItems.indexOf(e)&&this.allItems.push(e),this.movingItem===e&&this.floatItemUp(e),this.layoutChanged()}else this.autoSetItemPosition(e)},this.swapItems=function(e,t){this.grid[e.row][e.col]=t;var i=(this.grid[t.row][t.col]=e).row,r=e.col;e.row=t.row,e.col=t.col,t.row=i,t.col=r},this.moveOverlappingItems=function(e,t){t?-1===t.indexOf(e)&&(t=t.slice(0)).push(e):t=[e];var i=this.getItems(e.row,e.col,e.sizeX,e.sizeY,t);this.moveItemsDown(i,e.row+e.sizeY,t)},this.moveItemsDown=function(e,t,i){if(e&&0!==e.length){e.sort(function(e,t){return e.row-t.row}),i=i?i.slice(0):[];for(var r,n={},s=0,o=e.length;s<o;++s){var a=n[(r=e[s]).col];(void 0===a||r.row<a)&&(n[r.col]=r.row)}for(s=0,o=e.length;s<o;++s){var l=t-n[(r=e[s]).col];this.moveItemDown(r,r.row+l,i),i.push(r)}}},this.moveItemDown=function(e,t,i){if(!(e.row>=t)){for(;e.row<t;)++e.row,this.moveOverlappingItems(e,i);this.putItem(e,e.row,e.col,i)}},this.floatItemsUp=function(){if(!1!==this.floating)for(var e=0,t=this.grid.length;e<t;++e){var i=this.grid[e];if(i)for(var r=0,n=i.length;r<n;++r){var s=i[r];s&&this.floatItemUp(s)}}},this.floatItemUp=function(e){if(!1!==this.floating){for(var t=e.col,i=e.sizeY,r=e.sizeX,n=null,s=null,o=e.row-1;-1<o;){if(0!==this.getItems(o,t,r,i,e).length)break;n=o,s=t,--o}null!==n?this.putItem(e,n,s):e.initialSetup=!0}else e.initialSetup=!0},this.updateHeight=function(e){var t=this.minRows;e=e||0;for(var i=this.grid.length;0<=i;--i){var r=this.grid[i];if(r)for(var n=0,s=r.length;n<s;++n)r[n]&&(t=Math.max(t,i+e+r[n].sizeY))}this.gridHeight=0<this.maxRows-t?Math.min(this.maxRows,t):Math.max(this.maxRows,t)},this.pixelsToRows=function(e,t){return this.outerMargin||(e+=this.margins[0]/2),!0===t?Math.ceil(e/this.curRowHeight):!1===t?Math.floor(e/this.curRowHeight):Math.round(e/this.curRowHeight)},this.pixelsToColumns=function(e,t){return this.outerMargin||(e+=this.margins[1]/2),!0===t?Math.ceil(e/this.curColWidth):!1===t?Math.floor(e/this.curColWidth):Math.round(e/this.curColWidth)}}]).directive("gridsterPreview",function(){return{replace:!0,scope:!0,require:"^gridster",template:'<div ng-style="previewStyle()" class="gridster-item gridster-preview-holder"></div>',link:function(e,t,i,r){e.previewStyle=function(){return r.movingItem?{display:"block",height:r.movingItem.sizeY*r.curRowHeight-r.margins[0]+"px",width:r.movingItem.sizeX*r.curColWidth-r.margins[1]+"px",top:r.movingItem.row*r.curRowHeight+(r.outerMargin?r.margins[0]:0)+"px",left:r.movingItem.col*r.curColWidth+(r.outerMargin?r.margins[1]:0)+"px"}:{display:"none"}}}}}).directive("gridster",["$timeout","$window","$rootScope","gridsterDebounce",function(c,g,m,f){return{scope:!0,restrict:"EAC",controller:"GridsterCtrl",controllerAs:"gridster",compile:function(e){return e.prepend('<div ng-if="gridster.movingItem" gridster-preview></div>'),function(e,a,t,l){l.loaded=!1,l.$element=a,e.gridster=l,a.addClass("gridster");function d(e){return"hidden"!==e.style.visibility&&"none"!==e.style.display}function h(){a.css("height",l.gridHeight*l.curRowHeight+(l.outerMargin?l.margins[0]:-l.margins[0])+"px")}function i(e){if(l.setOptions(e),d(a[0])){"auto"===l.width?l.curWidth=a[0].offsetWidth||parseInt(a.css("width"),10):l.curWidth=l.width,"auto"===l.colWidth?l.curColWidth=(l.curWidth+(l.outerMargin?-l.margins[1]:l.margins[1]))/l.columns:l.curColWidth=l.colWidth,l.curRowHeight=l.rowHeight,"string"==typeof l.rowHeight&&("match"===l.rowHeight?l.curRowHeight=Math.round(l.curColWidth):-1!==l.rowHeight.indexOf("*")?l.curRowHeight=Math.round(l.curColWidth*l.rowHeight.replace("*","").replace(" ","")):-1!==l.rowHeight.indexOf("/")&&(l.curRowHeight=Math.round(l.curColWidth/l.rowHeight.replace("/","").replace(" ","")))),l.isMobile=l.mobileModeEnabled&&l.curWidth<=l.mobileBreakPoint;for(var t=0,i=l.grid.length;t<i;++t){var r=l.grid[t];if(r)for(var n,s=0,o=r.length;s<o;++s){r[s]&&((n=r[s]).setElementPosition(),n.setElementSizeY(),n.setElementSizeX())}}h()}}e.$watch(function(){return l.gridHeight},h),e.$watch(function(){return l.movingItem},function(){l.updateHeight(l.movingItem?l.movingItem.sizeY:0)});var r=t.gridster;r?e.$parent.$watch(r,function(e){i(e)},!0):i({}),e.$watch(function(){return l.loaded},function(){l.loaded?(a.addClass("gridster-loaded"),m.$broadcast("gridster-loaded",l)):a.removeClass("gridster-loaded")}),e.$watch(function(){return l.isMobile},function(){l.isMobile?a.addClass("gridster-mobile").removeClass("gridster-desktop"):a.removeClass("gridster-mobile").addClass("gridster-desktop"),m.$broadcast("gridster-mobile-changed",l)}),e.$watch(function(){return l.draggable},function(){m.$broadcast("gridster-draggable-changed",l)},!0),e.$watch(function(){return l.resizable},function(){m.$broadcast("gridster-resizable-changed",l)},!0);function n(){var e=a[0].offsetWidth||parseInt(a.css("width"),10);e&&e!==s&&!l.movingItem&&(s=e,l.loaded&&a.removeClass("gridster-loaded"),i(),l.loaded&&a.addClass("gridster-loaded"),m.$broadcast("gridster-resized",[e,a[0].offsetHeight],l))}var s=a[0].offsetWidth||parseInt(a.css("width"),10),o=f(function(){n(),c(function(){e.$apply()})},100);e.$watch(function(){return d(a[0])},o),"function"==typeof window.addResizeListener?window.addResizeListener(a[0],o):e.$watch(function(){return a[0].offsetWidth||parseInt(a.css("width"),10)},n);var u=R.element(g);u.on("resize",o),e.$on("$destroy",function(){l.destroy(),u.off("resize",o),"function"==typeof window.removeResizeListener&&window.removeResizeListener(a[0],o)}),c(function(){e.$watch("gridster.floating",function(){l.floatItemsUp()}),l.loaded=!0},100)}}}}]).controller("GridsterItemCtrl",function(){this.$element=null,this.gridster=null,this.row=null,this.col=null,this.sizeX=null,this.sizeY=null,this.minSizeX=0,this.minSizeY=0,this.maxSizeX=null,this.maxSizeY=null,this.init=function(e,t){this.$element=e,this.gridster=t,this.sizeX=t.defaultSizeX,this.sizeY=t.defaultSizeY},this.destroy=function(){this.gridster=null,this.$element=null},this.toJSON=function(){return{row:this.row,col:this.col,sizeY:this.sizeY,sizeX:this.sizeX}},this.isMoving=function(){return this.gridster.movingItem===this},this.setPosition=function(e,t){this.gridster.putItem(this,e,t),this.isMoving()||this.setElementPosition()},this.setSize=function(e,t,i){var r="size"+(e=e.toUpperCase()),n="Size"+e;if(""!==t){t=parseInt(t,10),!isNaN(t)&&0!==t||(t=this.gridster["default"+n]);var s="X"===e?this.gridster.columns:this.gridster.maxRows;this["max"+n]&&(s=Math.min(this["max"+n],s)),this.gridster["max"+n]&&(s=Math.min(this.gridster["max"+n],s)),"X"===e&&this.cols?s-=this.cols:"Y"===e&&this.rows&&(s-=this.rows);var o=0;this["min"+n]&&(o=Math.max(this["min"+n],o)),this.gridster["min"+n]&&(o=Math.max(this.gridster["min"+n],o)),t=Math.max(Math.min(t,s),o);var a=this[r]!==t||this["old"+n]&&this["old"+n]!==t;return this["old"+n]=this[r]=t,this.isMoving()||this["setElement"+n](),!i&&a&&(this.gridster.moveOverlappingItems(this),this.gridster.layoutChanged()),a}},this.setSizeY=function(e,t){return this.setSize("Y",e,t)},this.setSizeX=function(e,t){return this.setSize("X",e,t)},this.setElementPosition=function(){this.gridster.isMobile?this.$element.css({marginLeft:this.gridster.margins[0]+"px",marginRight:this.gridster.margins[0]+"px",marginTop:this.gridster.margins[1]+"px",marginBottom:this.gridster.margins[1]+"px",top:"",left:""}):this.$element.css({margin:0,top:this.row*this.gridster.curRowHeight+(this.gridster.outerMargin?this.gridster.margins[0]:0)+"px",left:this.col*this.gridster.curColWidth+(this.gridster.outerMargin?this.gridster.margins[1]:0)+"px"})},this.setElementSizeY=function(){this.gridster.isMobile&&!this.gridster.saveGridItemCalculatedHeightInMobile?this.$element.css("height",""):this.$element.css("height",this.sizeY*this.gridster.curRowHeight-this.gridster.margins[0]+"px")},this.setElementSizeX=function(){this.gridster.isMobile?this.$element.css("width",""):this.$element.css("width",this.sizeX*this.gridster.curColWidth-this.gridster.margins[1]+"px")},this.getElementSizeX=function(){return this.sizeX*this.gridster.curColWidth-this.gridster.margins[1]},this.getElementSizeY=function(){return this.sizeY*this.gridster.curRowHeight-this.gridster.margins[0]}}).factory("GridsterTouch",[function(){return function(u,c,g,m){function f(e){if(Object.keys)return Object.keys(e).length;var t,i=0;for(t in e)++i;return i}function v(e){for(var t=0,i=0,r=navigator.userAgent.match(/\bMSIE\b/),n=e;null!=n;n=n.offsetParent)r&&(!document.documentMode||document.documentMode<8)&&"relative"===n.currentStyle.position&&n.offsetParent&&"relative"===n.offsetParent.currentStyle.position&&n.offsetLeft===n.offsetParent.offsetLeft||(t+=n.offsetLeft),i+=n.offsetTop;return{x:t,y:i}}var e,t,p={},w=v(u),z=!1,b=function(e){if("mousemove"!==e.type||0!==f(p)){for(var t=!0,i=e.changedTouches?e.changedTouches:[e],r=0;r<i.length;++r){var n=i[r],s=void 0!==n.identifier?n.identifier:void 0!==n.pointerId?n.pointerId:1;if(void 0===n.pageX)if(n.pageX=n.offsetX+w.x,n.pageY=n.offsetY+w.y,n.srcElement.offsetParent===u&&document.documentMode&&8===document.documentMode&&"mousedown"===n.type)n.pageX+=n.srcElement.offsetLeft,n.pageY+=n.srcElement.offsetTop;else if(n.srcElement!==u&&!document.documentMode||document.documentMode<8){for(var o=-2,a=-2,l=n.srcElement;null!==l;l=l.parentNode)o+=l.scrollLeft?l.scrollLeft:0,a+=l.scrollTop?l.scrollTop:0;n.pageX=n.clientX+o,n.pageY=n.clientY+a}var d=n.pageX,h=n.pageY;e.type.match(/(start|down)$/i)?(w=v(u),p[s]&&(m&&m({target:e.target,which:e.which,pointerId:s,pageX:d,pageY:h}),delete p[s]),c&&(t=t&&c({target:e.target,which:e.which,pointerId:s,pageX:d,pageY:h})),p[s]={x:d,y:h},u.msSetPointerCapture&&t?u.msSetPointerCapture(s):"mousedown"===e.type&&1===f(p)&&(z?u.setCapture(!0):(document.addEventListener("mousemove",b,!1),document.addEventListener("mouseup",b,!1),document.addEventListener("mouseleave",b,!1)))):e.type.match(/move$/i)?!p[s]||p[s].x===d&&p[s].y===h||(g&&t&&(t=g({target:e.target,which:e.which,pointerId:s,pageX:d,pageY:h})),p[s].x=d,p[s].y=h):p[s]&&e.type.match(/(up|end|cancel|leave)$/i)&&(m&&t&&(t=m({target:e.target,which:e.which,pointerId:s,pageX:d,pageY:h})),delete p[s],u.msReleasePointerCapture?u.msReleasePointerCapture(s):"mouseup"===e.type&&0===f(p)&&(z?u.releaseCapture():(document.removeEventListener("mousemove",b,!1),document.removeEventListener("mouseup",b,!1),document.removeEventListener("mouseleave",b,!1))))}t&&(e.preventDefault&&e.preventDefault(),e.preventManipulation&&e.preventManipulation(),e.preventMouseEvent&&e.preventMouseEvent())}};return this.enable=function(){window.navigator.msPointerEnabled?(u.addEventListener("MSPointerDown",b,!1),u.addEventListener("MSPointerMove",b,!1),u.addEventListener("MSPointerUp",b,!1),u.addEventListener("MSPointerCancel",b,!1),void 0!==u.style.msContentZooming&&(e=u.style.msContentZooming,u.style.msContentZooming="none"),void 0!==u.style.msTouchAction&&(t=u.style.msTouchAction,u.style.msTouchAction="none")):u.addEventListener?(u.addEventListener("touchstart",b,!1),u.addEventListener("touchmove",b,!1),u.addEventListener("touchend",b,!1),u.addEventListener("touchcancel",b,!1),u.addEventListener("mousedown",b,!1),u.setCapture&&!window.navigator.userAgent.match(/\bGecko\b/)&&(z=!0,u.addEventListener("mousemove",b,!1),u.addEventListener("mouseup",b,!1))):u.attachEvent&&u.setCapture&&(z=!0,u.attachEvent("onmousedown",function(){return b(window.event),window.event.returnValue=!1}),u.attachEvent("onmousemove",function(){return b(window.event),window.event.returnValue=!1}),u.attachEvent("onmouseup",function(){return b(window.event),window.event.returnValue=!1}))},this.disable=function(){window.navigator.msPointerEnabled?(u.removeEventListener("MSPointerDown",b,!1),u.removeEventListener("MSPointerMove",b,!1),u.removeEventListener("MSPointerUp",b,!1),u.removeEventListener("MSPointerCancel",b,!1),e&&(u.style.msContentZooming=e),t&&(u.style.msTouchAction=t)):u.removeEventListener?(u.removeEventListener("touchstart",b,!1),u.removeEventListener("touchmove",b,!1),u.removeEventListener("touchend",b,!1),u.removeEventListener("touchcancel",b,!1),u.removeEventListener("mousedown",b,!1),u.setCapture&&!window.navigator.userAgent.match(/\bGecko\b/)&&(z=!0,u.removeEventListener("mousemove",b,!1),u.removeEventListener("mouseup",b,!1))):u.detachEvent&&u.setCapture&&(z=!0,u.detachEvent("onmousedown"),u.detachEvent("onmousemove"),u.detachEvent("onmouseup"))},this}}]).factory("GridsterDraggable",["$document","$window","GridsterTouch",function(s,L,o){return function(I,C,Y,X,S){var M,E,u,c,a=0,l=0,g=0,m=0,d=0,h=0,$=s[0],f=["select","option","input","textarea","button"];function e(e){if(-1!==f.indexOf(e.target.nodeName.toLowerCase()))return!1;var t,i=R.element(e.target);if(i.hasClass("gridster-item-resizable-handler"))return!1;if(i.attr("onclick")||i.attr("ng-click"))return!1;if(i.closest&&i.closest(".gridster-no-drag").length)return!1;if(Y.draggable&&Y.draggable.handle){var r=R.element(I[0].querySelectorAll(Y.draggable.handle)),n=!1;e:for(var s=0,o=r.length;s<o;++s){var a=r[s];if(a===e.target){n=!0;break}for(var l=e.target,d=0;d<20;++d){var h=l.parentNode;if(h===I[0]||!h)break;if(h===a){n=!0;break e}l=h}}if(!n)return!1}switch(e.which){case 1:break;case 2:case 3:return}return g=e.pageX,m=e.pageY,M=parseInt(I.css("left"),10),E=parseInt(I.css("top"),10),u=I[0].offsetWidth,c=I[0].offsetHeight,X.col,X.row,t=e,I.addClass("gridster-item-moving"),Y.movingItem=X,Y.updateHeight(X.sizeY),C.$apply(function(){Y.draggable&&Y.draggable.start&&Y.draggable.start(t,I,S,X)}),!0}function t(e){if(!I.hasClass("gridster-item-moving")||I.hasClass("gridster-item-resizing"))return!1;var t=Y.curWidth-1,i=Y.curRowHeight*Y.maxRows-1;a=e.pageX,l=e.pageY;var r=a-g+d,n=l-m+h;d=h=0,g=a,m=l;var s=r,o=n;return M+s<0?d=s-(r=0-M):t<M+u+s&&(d=s-(r=t-M-u)),E+o<0?h=o-(n=0-E):i<E+c+o&&(h=o-(n=i-E-c)),M+=r,E+=n,I.css({top:E+"px",left:M+"px"}),function(e){var t=X.row,i=X.col,r=Y.draggable&&Y.draggable.drag,n=Y.draggable.scrollSensitivity,s=Y.draggable.scrollSpeed,o=Math.min(Y.pixelsToRows(E),Y.maxRows-1),a=Math.min(Y.pixelsToColumns(M),Y.columns-1),l=Y.getItems(o,a,X.sizeX,X.sizeY,X),d=0!==l.length;if(!0===Y.swapping&&d){var h=Y.getBoundingBox(l),u=h.sizeX===X.sizeX&&h.sizeY===X.sizeY,c=h.row===t,g=h.col===i,m=h.row===o&&h.col===a,f=c||g;if(u&&1===l.length){if(m)Y.swapItems(X,l[0]);else if(f)return}else if(h.sizeX<=X.sizeX&&h.sizeY<=X.sizeY&&f)for(var v=X.row<=o?X.row:o+X.sizeY,p=X.col<=a?X.col:a+X.sizeX,w=v-h.row,z=p-h.col,b=0,x=l.length;b<x;++b){var y=l[b];0===Y.getItems(y.row+w,y.col+z,y.sizeX,y.sizeY,X).length&&Y.putItem(y,y.row+w,y.col+z)}}!1===Y.pushing&&d||(X.row=o,X.col=a),e.pageY-$.body.scrollTop<n?$.body.scrollTop=$.body.scrollTop-s:L.innerHeight-(e.pageY-$.body.scrollTop)<n&&($.body.scrollTop=$.body.scrollTop+s),e.pageX-$.body.scrollLeft<n?$.body.scrollLeft=$.body.scrollLeft-s:L.innerWidth-(e.pageX-$.body.scrollLeft)<n&&($.body.scrollLeft=$.body.scrollLeft+s),!r&&t===X.row&&i===X.col||C.$apply(function(){r&&Y.draggable.drag(e,I,S,X)})}(e),!0}function i(e){return!(!I.hasClass("gridster-item-moving")||I.hasClass("gridster-item-resizing"))&&(d=h=0,function(e){I.removeClass("gridster-item-moving");var t=Math.min(Y.pixelsToRows(E),Y.maxRows-1),i=Math.min(Y.pixelsToColumns(M),Y.columns-1);!1===Y.pushing&&0!==Y.getItems(t,i,X.sizeX,X.sizeY,X).length||(X.row=t,X.col=i),Y.movingItem=null,X.setPosition(X.row,X.col),C.$apply(function(){Y.draggable&&Y.draggable.stop&&Y.draggable.stop(e,I,S,X)})}(e),!0)}var r=null,n=null;this.enable=function(){!0!==r&&(r=!0,n?n.enable():(n=new o(I[0],e,t,i)).enable())},this.disable=function(){!1!==r&&(r=!1,n&&n.disable())},this.toggle=function(e){e?this.enable():this.disable()},this.destroy=function(){this.disable()}}}]).factory("GridsterResizable",["GridsterTouch",function(Y){return function(b,x,y,I,C){function e(u){function o(){return(I.minSizeY?I.minSizeY:1)*y.curRowHeight-y.margins[0]}function a(){return(I.minSizeX?I.minSizeX:1)*y.curColWidth-y.margins[1]}var c,g,m,f,i,l=u,d=0,h=0,v=0,p=0,w=0,z=0;function e(e){switch(e.which){case 1:break;case 2:case 3:return}var t;return(i=y.draggable.enabled)&&(y.draggable.enabled=!1,x.$broadcast("gridster-draggable-changed",y)),v=e.pageX,p=e.pageY,c=parseInt(b.css("left"),10),g=parseInt(b.css("top"),10),m=b[0].offsetWidth,f=b[0].offsetHeight,I.sizeX,I.sizeY,t=e,b.addClass("gridster-item-moving"),b.addClass("gridster-item-resizing"),(y.movingItem=I).setElementSizeX(),I.setElementSizeY(),I.setElementPosition(),y.updateHeight(1),x.$apply(function(){y.resizable&&y.resizable.start&&y.resizable.start(t,b,C,I)}),!0}function t(e){var t=y.curWidth-1;d=e.pageX,h=e.pageY;var i=d-v+w,r=h-p+z;w=z=0,v=d,p=h;var n=r,s=i;return 0<=l.indexOf("n")&&(f-n<o()?(r=f-o(),z=n-r):g+n<0&&(z=n-(r=0-g)),g+=r,f-=r),0<=l.indexOf("s")&&(f+n<o()?(r=o()-f,z=n-r):9999<g+f+n&&(z=n-(r=9999-g-f)),f+=r),0<=l.indexOf("w")&&(m-s<a()?(i=m-a(),w=s-i):c+s<0&&(w=s-(i=0-c)),c+=i,m-=i),0<=l.indexOf("e")&&(m+s<a()?(i=a()-m,w=s-i):t<c+m+s&&(w=s-(i=t-c-m)),m+=i),b.css({top:g+"px",left:c+"px",width:m+"px",height:f+"px"}),function(e){var t=I.row,i=I.col,r=I.sizeX,n=I.sizeY,s=y.resizable&&y.resizable.resize,o=I.col;-1!==["w","nw","sw"].indexOf(u)&&(o=y.pixelsToColumns(c,!1));var a=I.row;-1!==["n","ne","nw"].indexOf(u)&&(a=y.pixelsToRows(g,!1));var l=I.sizeX;-1===["n","s"].indexOf(u)&&(l=y.pixelsToColumns(m,!0));var d=I.sizeY;-1===["e","w"].indexOf(u)&&(d=y.pixelsToRows(f,!0)),-1<a&&-1<o&&l+o<=y.columns&&d+a<=y.maxRows&&(!1!==y.pushing||0===y.getItems(a,o,l,d,I).length)&&(I.row=a,I.col=o,I.sizeX=l,I.sizeY=d);var h=I.row!==t||I.col!==i||I.sizeX!==r||I.sizeY!==n;(s||h)&&x.$apply(function(){s&&y.resizable.resize(e,b,C,I)})}(e),!0}function r(e){var t;return y.draggable.enabled!==i&&(y.draggable.enabled=i,x.$broadcast("gridster-draggable-changed",y)),w=z=0,t=e,b.removeClass("gridster-item-moving"),b.removeClass("gridster-item-resizing"),y.movingItem=null,I.setPosition(I.row,I.col),I.setSizeY(I.sizeY),I.setSizeX(I.sizeX),x.$apply(function(){y.resizable&&y.resizable.stop&&y.resizable.stop(t,b,C,I)}),!0}var n,s=null;this.enable=function(){s||(s=R.element('<div class="gridster-item-resizable-handler handle-'+l+'"></div>'),b.append(s)),(n=new Y(s[0],e,t,r)).enable()},this.disable=function(){s&&(s.remove(),s=null),n.disable(),n=void 0},this.destroy=function(){this.disable()}}var i=[],t=y.resizable.handles;"string"==typeof t&&(t=y.resizable.handles.split(","));for(var r=!1,n=0,s=t.length;n<s;n++)i.push(new e(t[n]));this.enable=function(){if(!r){for(var e=0,t=i.length;e<t;e++)i[e].enable();r=!0}},this.disable=function(){if(r){for(var e=0,t=i.length;e<t;e++)i[e].disable();r=!1}},this.toggle=function(e){e?this.enable():this.disable()},this.destroy=function(){for(var e=0,t=i.length;e<t;e++)i[e].destroy()}}}]).factory("gridsterDebounce",function(){return function(r,n,s){var o;return function(){var e=this,t=arguments,i=s&&!o;clearTimeout(o),o=setTimeout(function(){o=null,s||r.apply(e,t)},n),i&&r.apply(e,t)}}}).directive("gridsterItem",["$parse","GridsterDraggable","GridsterResizable","gridsterDebounce",function(b,x,y,I){return{scope:!0,restrict:"EA",controller:"GridsterItemCtrl",controllerAs:"gridsterItem",require:["^gridster","gridsterItem"],link:function(r,e,t,i){var n,s,o=t.gridsterItem,a=i[0],l=i[1];r.gridster=a,o?(n=b(o),!(s=n(r)||{})&&n.assign&&(s={row:l.row,col:l.col,sizeX:l.sizeX,sizeY:l.sizeY,minSizeX:0,minSizeY:0,maxSizeX:null,maxSizeY:null},n.assign(r,s))):s=t,l.init(e,a),e.addClass("gridster-item");var d=["minSizeX","maxSizeX","minSizeY","maxSizeY","sizeX","sizeY","row","col"],h={},u=[];l.initialSetup=!1;for(var c=0,g=d.length;c<g;++c)!function(e){var t;if("string"==typeof s[e])t=s[e];else if("string"==typeof s[e.toLowerCase()])t=s[e.toLowerCase()];else{if(!o)return;t=o+"."+e}u.push('"'+e+'":'+t),h[e]=b(t);var i=h[e](r);"number"==typeof i&&(l[e]=i)}(d[c]);var m="{"+u.join(",")+"}";r.$watchCollection(m,function(e,t){for(var i in e){var r=e[i];t[i]!==r&&(r=parseInt(r,10),isNaN(r)||(l[i]=r))}}),r.$watch(function(){return l.row+","+l.col},function(){l.setPosition(l.row,l.col),h.row&&h.row.assign&&h.row.assign(r,l.row),h.col&&h.col.assign&&h.col.assign(r,l.col)}),r.$watch(function(){return l.sizeY+","+l.sizeX+","+l.minSizeX+","+l.maxSizeX+","+l.minSizeY+","+l.maxSizeY},function(){var e=l.setSizeX(l.sizeX,!0);e&&h.sizeX&&h.sizeX.assign&&h.sizeX.assign(r,l.sizeX);var t=l.setSizeY(l.sizeY,!0);t&&h.sizeY&&h.sizeY.assign&&h.sizeY.assign(r,l.sizeY),(e||t)&&(l.gridster.moveOverlappingItems(l),a.layoutChanged(),r.$broadcast("gridster-item-resized",l))});function f(){p.toggle(!a.isMobile&&a.resizable&&a.resizable.enabled)}var v=new x(e,r,a,l,s),p=new y(e,r,a,l,s);f();function w(){v.toggle(!a.isMobile&&a.draggable&&a.draggable.enabled)}w(),r.$on("gridster-draggable-changed",w),r.$on("gridster-resizable-changed",f),r.$on("gridster-resized",f),r.$on("gridster-mobile-changed",function(){f(),w()});var z=I(function(){r.$apply(function(){r.$broadcast("gridster-item-transition-end",l)})},50);return e.on(function(){var e=document.createElement("div"),t={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(var i in t)if(void 0!==e.style[i])return t[i]}(),z),r.$broadcast("gridster-item-initialized",l),r.$on("$destroy",function(){try{p.destroy(),v.destroy()}catch(e){}try{a.removeItem(l)}catch(e){}a.grid&&a.grid.flat().filter(function(e){return null!=e}).length<=0&&(a.initialSetupComplete=!1);try{l.destroy()}catch(e){}})}}}]).directive("gridsterNoDrag",function(){return{restrict:"A",link:function(e,t){t.addClass("gridster-no-drag")}}})});